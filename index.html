<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Authentication System</title>

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family: 'Segoe UI', sans-serif;
}

body{
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background: linear-gradient(135deg, #ffffff, #f3f0ff);
}

.container{
    width:100%;
    max-width:360px;
    padding:30px;
    border-radius:20px;
    background: #ffffff;
    box-shadow:
        0 10px 40px rgba(124, 58, 237, 0.15);
    border:1px solid rgba(124, 58, 237, 0.2);
}

h2{
    text-align:center;
    margin-bottom:20px;
    color:#4c1d95;
}

input{
    width:100%;
    padding:14px;
    margin:8px 0;
    border-radius:12px;
    border:1px solid #ddd;
    background:#fafafa;
    color:#333;
    transition:0.3s;
}

input::placeholder{
    color:#999;
}

input:focus{
    outline:none;
    border-color:#7c3aed;
    box-shadow:0 0 8px rgba(124,58,237,0.4);
    background:white;
}

button{
    width:100%;
    padding:14px;
    margin-top:12px;
    border:none;
    border-radius:12px;
    font-weight:600;
    cursor:pointer;
    background: linear-gradient(90deg, #7c3aed, #a78bfa);
    color:white;
    transition:0.3s;
}

button:hover{
    box-shadow:0 6px 20px rgba(124,58,237,0.4);
    transform:translateY(-2px);
}

.google{
    background:white;
    color:#4c1d95;
    border:1px solid #ddd;
}

.google:hover{
    background:#f3f0ff;
}

.link{
    text-align:center;
    margin-top:15px;
    font-size:14px;
    color:#7c3aed;
    cursor:pointer;
}

.link:hover{
    text-decoration:underline;
}

.dashboard{
    text-align:center;
    color:#4c1d95;
}

.dashboard p{
    margin:15px 0;
    color:#6d28d9;
}

.hidden{
    display:none;
}
</style>
</head>

<body>

<div class="container">

    <!-- SIGN UP -->
    <div id="signupDiv">
        <h2>Create Account</h2>
        <input type="text" id="signupFirstName" placeholder="First Name">
        <input type="text" id="signupLastName" placeholder="Last Name">
        <input type="email" id="signupEmail" placeholder="Email">
        <input type="password" id="signupPassword" placeholder="Password">
        <button id="signupBtn">Sign Up</button>
        <button class="google" id="googleSignUp">Sign Up with Google</button>
        <div class="link" onclick="showLogin()">Already have an account? Log In</div>
    </div>

    <!-- LOGIN -->
    <div id="loginDiv" class="hidden">
        <h2>Login</h2>
        <input type="email" id="loginEmail" placeholder="Email">
        <input type="password" id="loginPassword" placeholder="Password">
        <div class="link" id="forgotPassword">Forgot Password?</div>
        <button id="loginBtn">Log In</button>
        <button class="google" id="googleLogin">Log In with Google</button>
        <div class="link" onclick="showSignup()">Don't have an account? Sign Up</div>
    </div>

    <!-- DASHBOARD -->
    <div id="dashboard" class="hidden dashboard">
        <h2>Welcome</h2>
        <p id="userEmail"></p>
        <button id="logoutBtn">Log Out</button>
    </div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { 
    getAuth, 
    createUserWithEmailAndPassword,
    signInWithEmailAndPassword,
    GoogleAuthProvider,
    signInWithPopup,
    signOut,
    onAuthStateChanged,
    sendPasswordResetEmail,
    updateProfile
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBfeFZgZwwE0iINLr5vkZumMWQpdx26HCs",
  authDomain: "it325-assignmentdimatera.firebaseapp.com",
  projectId: "it325-assignmentdimatera",
  storageBucket: "it325-assignmentdimatera.firebasestorage.app",
  messagingSenderId: "187058646621",
  appId: "1:187058646621:web:ff845f231bb35ecdc9a7b4"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const provider = new GoogleAuthProvider();

window.showLogin = function(){
    signupDiv.classList.add("hidden");
    loginDiv.classList.remove("hidden");
}

window.showSignup = function(){
    loginDiv.classList.add("hidden");
    signupDiv.classList.remove("hidden");
}

signupBtn.onclick = async () => {
    try {
        const userCredential = await createUserWithEmailAndPassword(
            auth,
            signupEmail.value,
            signupPassword.value
        );

        await updateProfile(userCredential.user, {
            displayName: signupFirstName.value + " " + signupLastName.value
        });

        alert("Account created successfully!");
    } catch (error) {
        alert(error.message);
    }
};

googleSignUp.onclick = () => signInWithPopup(auth, provider);
googleLogin.onclick = () => signInWithPopup(auth, provider);

loginBtn.onclick = () => {
    signInWithEmailAndPassword(auth, loginEmail.value, loginPassword.value)
    .catch(error => alert(error.message));
};

forgotPassword.onclick = () => {
    if(loginEmail.value === ""){
        alert("Enter your email first.");
        return;
    }

    sendPasswordResetEmail(auth, loginEmail.value)
    .then(() => alert("Password reset email sent!"))
    .catch(error => alert(error.message));
};

logoutBtn.onclick = () => signOut(auth);

onAuthStateChanged(auth, (user) => {
    if(user){
        signupDiv.classList.add("hidden");
        loginDiv.classList.add("hidden");
        dashboard.classList.remove("hidden");

        userEmail.innerText = user.displayName
            ? user.displayName + " (" + user.email + ")"
            : user.email;
    } else {
        dashboard.classList.add("hidden");
        signupDiv.classList.remove("hidden");
    }
});
</script>

</body>
</html>
